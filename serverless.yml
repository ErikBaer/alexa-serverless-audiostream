service: HelloWorld
provider:
  name: aws
  runtime: nodejs12.x
  stage: dev
  region: eu-central-1
  iamRoleStatements:
    - Effect: "Allow"
      Action:
        - dynamoDB:CreateTable
        - dynamoDB:GetItem
        - dynamoDB:PutItem
      Resource: "arn:aws:dynamodb:*:*:table/usersTable"

functions:
  alexa:
    handler: index.handler
    events:
      - alexaSkill: ${file(config_variables.json):alexa.apis.skillID}

plugins:
  - serverless-plugin-typescript
  - serverless-alexa-skills

resources: # CloudFormation template syntax
  Resources:
    usersTable:
      Type: AWS::DynamoDB::Table
      Properties:
        TableName: usersTable
        AttributeDefinitions:
          - AttributeName: id
            AttributeType: S
        KeySchema:
          - AttributeName: id
            KeyType: HASH
        ProvisionedThroughput:
          ReadCapacityUnits: 1
          WriteCapacityUnits: 1

custom:
  alexa:
    vendorId: ${file(config_variables.json):alexa.credentials.vendorId}
    clientId: ${file(config_variables.json):alexa.credentials.clientId}
    clientSecret: ${file(config_variables.json):alexa.credentials.clientSecret}
    skills:
      - id: ${file(config_variables.json):alexa.apis.skillID}
        manifest:
          apis:
            custom:
              endpoint:
                uri: ${file(config_variables.json):alexa.apis.lambdaURI}
              interfaces:
                - type: AUDIO_PLAYER
          manifestVersion: '1.0'
          publishingInformation:
            category: STREAMING_SERVICE
            distributionCountries: [ ]
            isAvailableWorldwide: true
            locales:
              de-DE:
                description: Streame deine liebste Radiostation - WRD2
                examplePhrases:
                  - Alexa öffne baer data
                  - öffne baer data
                  - starte baer data
                keywords: [ ]
                name: baer-data
                summary: Radio-stream
            testingInstructions: Sample Testing Instructions.
        models:
          ${file(models/model.json):de-model}





